<html>
<head>
    <title>SIP Devices</title>
    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">

    <script>
        function refreshOne(ipAddr) {
            $.get('/refreshOne?ip=' + ipAddr+'', function(data) {
                console.log('Refreshed ip');
            });
        }
        function refreshAll() {
            $.get("/refresh", function(data) {
                $('#status').html('');
            });
        }
        setInterval(function(){
            $.get( "/devices", function( data ) {
                var table="<table class='table table-bordered' ><tr><th>Name</th><th>IP</th><th>Status</th><th>Action</th></tr>"
                for(var key in data){
                    table += "<tr><td>";
                    table += key;
                    table += "</td><td>";
                    table += data[key].ip;
                    table += "</td class='text-center'><td>";
                    if(data[key].status == "up"){
                        table += "<span class='label label-success'>"
                    }else{
                        table += "<span class='label label-danger'>"
                    }
                    table += data[key].status;
                    table += "</span></td>";
                    table += "<td class='text-center'><button><span class='glyphicon glyphicon-refresh text-info' onClick=\"refreshOne('"+ data[key].ip +"')\"></span></button></td>"
                    table += "</tr>";

                }
                table += "</table>"
                $('#status').html(table);
            });

        }, 2000);
    </script>
</head>
<body>
    <button class="btn btn-primary" onclick="refreshAll()">Refresh All</button>
    <div id='status' style='width:550px'>
    </div>
</body>
</html>
